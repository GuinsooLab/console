"use strict";(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[9449],{99449:function(e,a,t){t.r(a),t.d(a,{default:function(){return w}});var n=t(29439),s=t(1413),i=t(72791),l=t(60364),r=t(11135),o=t(25787),c=t(61889),d=t(23814),u=t(51691),m=t(10703),h=t(93433),g=t(56028),x=t(36151),v=t(81207),Z=t(32509),j=t(21435),p=t(40968),f=t(56578),C=t(87995),N=t(81551),b=t(80184),y=(0,o.Z)((function(e){return(0,r.Z)((0,s.Z)((0,s.Z)((0,s.Z)({buttonContainer:{textAlign:"right"}},d.oO),d.ID),d.DF))}))((function(e){e.tenant;var a=e.classes,t=e.open,s=e.onClose,l=e.image,r=e.sidecarImage,o=e.initImage,d=e.labels,u=e.annotations,m=e.nodeSelector,y=e.diskCapacityGB,A=e.serviceAccountName,S=e.storageClassName,P=e.tenantName,I=e.tenantNamespace,R=e.cpuRequest,q=e.memRequest,k=(0,N.TL)(),z=(0,i.useState)({}),w=(0,n.Z)(z,2),M=w[0],G=w[1],F=(0,i.useState)(d.length>0?(0,h.Z)(d):[{key:"",value:""}]),E=(0,n.Z)(F,2),B=E[0],U=E[1],L=(0,i.useState)(u.length>0?(0,h.Z)(u):[{key:"",value:""}]),O=(0,n.Z)(L,2),D=O[0],T=O[1],_=(0,i.useState)(m.length>0?(0,h.Z)(m):[{key:"",value:""}]),K=(0,n.Z)(_,2),$=K[0],V=K[1],Y=(0,i.useState)(l),H=(0,n.Z)(Y,2),J=H[0],Q=H[1],W=(0,i.useState)(r),X=(0,n.Z)(W,2),ee=X[0],ae=X[1],te=(0,i.useState)(o),ne=(0,n.Z)(te,2),se=ne[0],ie=ne[1],le=(0,i.useState)(y.toString()),re=(0,n.Z)(le,2),oe=re[0],ce=re[1],de=(0,i.useState)(R),ue=(0,n.Z)(de,2),me=ue[0],he=ue[1],ge=(0,i.useState)(q?Math.floor(parseInt(q,10)/1e9).toString():""),xe=(0,n.Z)(ge,2),ve=xe[0],Ze=xe[1],je=(0,i.useState)(A),pe=(0,n.Z)(je,2),fe=pe[0],Ce=pe[1],Ne=(0,i.useState)(S),be=(0,n.Z)(Ne,2),ye=be[0],Ae=be[1],Se=(0,i.useState)({}),Pe=(0,n.Z)(Se,2),Ie=Pe[0],Re=Pe[1],qe=(0,i.useState)({}),ke=(0,n.Z)(qe,2),ze=ke[0],we=ke[1],Me=(0,i.useState)({}),Ge=(0,n.Z)(Me,2),Fe=Ge[0],Ee=Ge[1],Be=function(e){for(var a=[],t=0;t<e.length;t++)""!==e[t].key&&a.push(e[t]);return a};(0,i.useEffect)((function(){var e=[];e.push({fieldKey:"image",required:!1,value:J,pattern:/^([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9]?)+(\/(([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9])?)+)*:([a-zA-Z0-9])[a-zA-Z0-9-.]{0,127}$/,customPatternMessage:"Invalid image"}),e.push({fieldKey:"sidecarImage",required:!1,value:ee,pattern:/^([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9]?)+(\/(([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9])?)+)*:([a-zA-Z0-9])[a-zA-Z0-9-.]{0,127}$/,customPatternMessage:"Invalid image"}),e.push({fieldKey:"initImage",required:!1,value:se,pattern:/^([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9]?)+(\/(([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9])?)+)*:([a-zA-Z0-9])[a-zA-Z0-9-.]{0,127}$/,customPatternMessage:"Invalid image"}),e.push({fieldKey:"diskCapacityGB",required:!0,value:oe,pattern:/^[0-9]*$/,customPatternMessage:"Must be an integer between 0 and 10"}),e.push({fieldKey:"newCPURequest",required:!1,value:me,pattern:/^[0-9]*$/,customPatternMessage:"Must be an integer between 0 and 10"}),e.push({fieldKey:"newMemRequest",required:!1,value:ve,pattern:/^[0-9]*$/,customPatternMessage:"Must be an integer between 0 and 10"}),e.push({fieldKey:"serviceAccountName",required:!1,value:fe,pattern:/^[a-zA-Z0-9-.]{1,253}$/,customPatternMessage:"Invalid service account name"}),e.push({fieldKey:"storageClassName",required:!1,value:ye,pattern:/^[a-zA-Z0-9-.]{1,253}$/,customPatternMessage:"Invalid storage class name"});var a=(0,p.R)(e);G(a)}),[J,ee,se,oe,fe,ye,me,ve,G]);return(0,b.jsx)(g.Z,{onClose:function(){return s(!0)},modalOpen:t,title:"Edit Monitoring Configuration",children:(0,b.jsx)("form",{noValidate:!0,autoComplete:"off",onSubmit:function(e){e.preventDefault(),v.Z.invoke("PUT","/api/v1/namespaces/".concat(I,"/tenants/").concat(P,"/monitoring"),{labels:Be(B),annotations:Be(D),nodeSelector:Be($),image:J,sidecarImage:ee,initImage:se,diskCapacityGB:oe,serviceAccountName:fe,storageClassName:ye,monitoringCPURequest:me,monitoringMemRequest:ve+"Gi"}).then((function(){s(!0)})).catch((function(e){}))},children:(0,b.jsxs)(c.ZP,{container:!0,children:[(0,b.jsxs)(c.ZP,{xs:12,className:a.modalFormScrollable,children:[(0,b.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,b.jsx)(j.Z,{id:"image",label:"Image",placeholder:"quay.io/prometheus/prometheus:latest",name:"image",value:J,onChange:function(e){Q(e.target.value)},error:M.image||""},"image")}),(0,b.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,b.jsx)(j.Z,{id:"sidecarImage",label:"Sidecar Image",placeholder:"library/alpine:latest",name:"sidecarImage",value:ee,onChange:function(e){ae(e.target.value)},error:M.sidecarImage||""},"sidecarImage")}),(0,b.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,b.jsx)(j.Z,{id:"initImage",label:"Init Image",placeholder:"library/busybox:1.33.1",name:"initImage",value:se,onChange:function(e){ie(e.target.value)},error:M.initImage||""},"initImage")}),(0,b.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,b.jsx)(j.Z,{id:"diskCapacityGB",label:"Disk Capacity",placeholder:"Disk Capacity",name:"diskCapacityGB",value:oe,onChange:function(e){ce(e.target.value)},error:M.diskCapacityGB||"",overlayObject:(0,b.jsx)(f.Z,{id:"size-unit",onUnitChange:function(){},unitSelected:"Gi",unitsList:[{label:"Gi",value:"Gi"}],disabled:!0})},"diskCapacityGB")}),(0,b.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,b.jsx)(j.Z,{id:"cpuRequest",label:"CPU Request",placeholder:"CPU Request",name:"cpuRequest",value:me,onChange:function(e){he(e.target.value)},error:M.cpuRequest||""},"cpuRequest")}),(0,b.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,b.jsx)(j.Z,{id:"memRequest",label:"Memory Request",placeholder:"Memory request",name:"memRequest",value:ve,onChange:function(e){e.target.validity.valid&&Ze(e.target.value)},pattern:"[0-9]*",error:M.memRequest||"",overlayObject:(0,b.jsx)(f.Z,{id:"size-unit",onUnitChange:function(){},unitSelected:"Gi",unitsList:[{label:"Gi",value:"Gi"}],disabled:!0})},"memRequest")}),(0,b.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,b.jsx)(j.Z,{id:"serviceAccountName",label:"Service Account",placeholder:"Service Account Name",name:"serviceAccountName",value:fe,onChange:function(e){Ce(e.target.value)},error:M.serviceAccountName||""},"serviceAccountName")}),(0,b.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,b.jsx)(j.Z,{id:"storageClassName",label:"Storage Class",placeholder:"Storage Class Name",name:"storageClassName",value:ye,onChange:function(e){Ae(e.target.value)},error:M.storageClassName||""},"storageClassName")}),(0,b.jsxs)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:[(0,b.jsx)("span",{className:a.inputLabel,children:"Labels"}),(0,b.jsx)(Z.Z,{newValues:B,setNewValues:U,paramName:"Labels",error:Ie,setError:Re})]}),(0,b.jsxs)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:[(0,b.jsx)("span",{className:a.inputLabel,children:"Annotations"}),(0,b.jsx)(Z.Z,{newValues:D,setNewValues:T,paramName:"Annotations",error:ze,setError:we})]}),(0,b.jsxs)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:[(0,b.jsx)("span",{className:a.inputLabel,children:"Node Selector"}),(0,b.jsx)(Z.Z,{newValues:$,setNewValues:V,paramName:"Node Selector",error:Fe,setError:Ee})]})]}),(0,b.jsx)(c.ZP,{xs:12,className:a.buttonContainer,children:(0,b.jsx)(x.Z,{type:"submit",variant:"contained",color:"primary",disabled:!function(){if(0!==Object.keys(M).length||0!==Object.keys(Ie).length||0!==Object.keys(ze).length||0!==Object.keys(Fe).length){return k((0,C.zb)({errorMessage:"Invalid entry",detailedError:""})),!1}return!0}(),children:"Save"})})]})})})})),A=t(3923),S=t(37516),P=t(47879),I=t(45248),R=t(2148),q=t(40603),k=t(72401),z=t(16871),w=(0,o.Z)((function(e){return(0,r.Z)((0,s.Z)((0,s.Z)((0,s.Z)((0,s.Z)({},d.oZ),{},{paperContainer:{padding:"15px 15px 15px 50px"}},d.OR),d.qg),(0,d.Bz)(e.spacing(4))))}))((function(e){var a=e.classes,t=(0,N.TL)(),s=(0,z.UO)(),r=s.tenantName,o=s.tenantNamespace,d=(0,l.v9)((function(e){return e.tenants.loadingTenant})),h=(0,l.v9)((function(e){return e.tenants.tenantInfo})),g=(0,i.useState)(!1),x=(0,n.Z)(g,2),Z=x[0],j=x[1],p=(0,i.useState)(!1),f=(0,n.Z)(p,2),w=f[0],M=f[1],G=(0,i.useState)(),F=(0,n.Z)(G,2),E=F[0],B=F[1],U=(0,i.useState)(!1),L=(0,n.Z)(U,2),O=L[0],D=L[1],T=(0,i.useState)(!0),_=(0,n.Z)(T,2),K=_[0],$=_[1];(0,i.useEffect)((function(){K&&v.Z.invoke("GET","/api/v1/namespaces/".concat(o||"","/tenants/").concat(r||"","/monitoring")).then((function(e){j(e.prometheusEnabled),B(e),$(!1)})).catch((function(e){t((0,C.Ih)(e)),$(!1)}))}),[K]);return(0,b.jsxs)(i.Fragment,{children:[w&&null!==h&&Z&&(0,b.jsx)(y,{classes:a,open:w,onClose:function(){M(!1),$(!0)},tenant:h,image:(null===E||void 0===E?void 0:E.image)||"",sidecarImage:(null===E||void 0===E?void 0:E.sidecarImage)||"",initImage:(null===E||void 0===E?void 0:E.initImage)||"",diskCapacityGB:null!==E&&void 0!==E&&E.diskCapacityGB?parseInt(null===E||void 0===E?void 0:E.diskCapacityGB):5,labels:(null===E||void 0===E?void 0:E.labels)||[],annotations:(null===E||void 0===E?void 0:E.annotations)||[],nodeSelector:(null===E||void 0===E?void 0:E.nodeSelector)||[],serviceAccountName:(null===E||void 0===E?void 0:E.serviceAccountName)||"",tenantName:r||"",tenantNamespace:o||"",storageClassName:(null===E||void 0===E?void 0:E.storageClassName)||"",cpuRequest:(null===E||void 0===E?void 0:E.monitoringCPURequest)||"",memRequest:(null===E||void 0===E?void 0:E.monitoringMemRequest)||""}),O&&(0,b.jsx)(R.Z,{isOpen:O,title:Z?"Disable Prometheus monitoring?":"Enable Prometheus monitoring?",confirmText:Z?"Disable":"Enable",cancelText:"Cancel",onClose:function(){return D(!1)},onConfirm:function(){var e={prometheusEnabled:Z,toggle:!0};v.Z.invoke("PUT","/api/v1/namespaces/".concat(o,"/tenants/").concat(r,"/monitoring"),e).then((function(){j(!Z),$(!0),D(!1),$(!0)})).catch((function(e){t((0,C.Ih)(e))}))},confirmationContent:(0,b.jsx)(u.Z,{children:Z?"Disabling monitoring will erase any custom values you have used to configure Prometheus monitoring":"Prometheus monitoring will be enabled with default values"})}),(0,b.jsxs)(c.ZP,{container:!0,alignItems:"center",children:[(0,b.jsx)(c.ZP,{item:!0,xs:!0,children:(0,b.jsx)("h1",{className:a.sectionTitle,children:"Monitoring"})}),(0,b.jsx)(c.ZP,{item:!0,xs:4,children:(0,b.jsx)(S.Z,{indicatorLabels:["Enabled","Disabled"],checked:Z,value:"monitoring_status",id:"monitoring-status",name:"monitoring-status",onChange:function(e){D(!0)},description:""})})]}),Z&&void 0!==E&&(0,b.jsx)(m.Z,{className:a.paperContainer,children:(0,b.jsxs)(c.ZP,{container:!0,children:[(0,b.jsx)(c.ZP,{item:!0,xs:12,children:(0,b.jsxs)(c.ZP,{container:!0,alignItems:"center",children:[(0,b.jsx)(c.ZP,{xs:8,children:(0,b.jsx)("h3",{children:"Configuration"})}),(0,b.jsx)(c.ZP,{xs:4,justifyContent:"end",textAlign:"right",children:(0,b.jsx)(q.Z,{tooltip:"Edit Monitoring configuration",text:"Edit",onClick:function(){M(!0)},icon:(0,b.jsx)(A.dY8,{}),color:"primary",variant:"contained"})})]})}),(0,b.jsxs)(c.ZP,{item:!0,xs:12,children:[(0,b.jsx)("hr",{className:a.hrClass}),(0,b.jsx)("table",{width:"100%",children:(0,b.jsx)("tbody",{children:d?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{className:a.centerAlign,colSpan:4,children:(0,b.jsx)(k.Z,{})})}):(0,b.jsxs)(i.Fragment,{children:[null!=E.image&&(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:a.titleCol,children:"Image:"}),(0,b.jsx)("td",{children:E.image})]}),null!=E.sidecarImage&&(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:a.titleCol,children:"Sidecar Image:"}),(0,b.jsx)("td",{children:null===E||void 0===E?void 0:E.sidecarImage})]}),null!=E.initImage&&(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:a.titleCol,children:"Init Image:"}),(0,b.jsx)("td",{children:null===E||void 0===E?void 0:E.initImage})]}),null!=E.diskCapacityGB&&(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:a.titleCol,children:"Disk Capacity (GB):"}),(0,b.jsx)("td",{children:null===E||void 0===E?void 0:E.diskCapacityGB})]}),null!=E.serviceAccountName&&(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:a.titleCol,children:"Service Account Name:"}),(0,b.jsx)("td",{children:null===E||void 0===E?void 0:E.serviceAccountName})]}),null!=E.storageClassName&&(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:a.titleCol,children:"Storage Class Name:"}),(0,b.jsx)("td",{children:null===E||void 0===E?void 0:E.storageClassName})]}),null!=E.labels&&E.labels.length>0&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("tr",{children:(0,b.jsx)("td",{children:(0,b.jsx)("h4",{children:"Labels"})})}),(0,b.jsx)("tr",{children:(0,b.jsx)("td",{className:a.titleCol,children:(0,b.jsx)(P.Z,{records:E.labels,recordName:"Labels"})})})]}),null!=E.annotations&&E.annotations.length>0&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("tr",{children:(0,b.jsx)("td",{children:(0,b.jsx)("h4",{children:"Annotations"})})}),(0,b.jsx)("tr",{children:(0,b.jsx)("td",{className:a.titleCol,children:(0,b.jsx)(P.Z,{records:E.annotations,recordName:"Annotations"})})})]}),null!=E.monitoringCPURequest&&(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:a.titleCol,children:"CPU Request:"}),(0,b.jsx)("td",{children:null===E||void 0===E?void 0:E.monitoringCPURequest})]}),null!=E.monitoringMemRequest&&(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:a.titleCol,children:"Memory Request:"}),(0,b.jsx)("td",{children:(0,I.ae)(null===E||void 0===E?void 0:E.monitoringMemRequest,!0)})]}),null!=E.nodeSelector&&E.nodeSelector.length>0&&(0,b.jsxs)("tr",{children:[(0,b.jsx)("h4",{children:"Node Selector:"}),(0,b.jsx)("td",{className:a.titleCol,children:(0,b.jsx)(P.Z,{records:E.nodeSelector,recordName:"Node Selector"})})]})]})})})]})]})})]})}))}}]);
//# sourceMappingURL=9449.2b80f120.chunk.js.map